<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<TITLE>FutureSuite MCI Reference Manual</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#000080" ALINK="#FF0000">
<A HREF="mci_en_TOC.html">Table of Contents</A>
<DIV ALIGN=RIGHT>FutureSuite MCI Reference Manual</DIV>
<HR>
<A HREF="mci_en_fla.examples.html">[Up]</A>
<A HREF="mci_en_fla.examples.UTL_WriteFailListBadBlock.html">[Prev]</A>
<A HREF="mci_en_fla.examples.UTL_WriteFailList.html">[Next]</A>
<HR>
<h1><a name="fla.examples.UTL_ReadFailList">Example of using UTL_ReadFailList()</a></h1>

<p>
Below is an example that reads the number of failing addresses, fail address information and its data, and calculates which ECC sector the failing address belongs to.
</p>
<p><a name=""><table border="1" cellpadding="0" width="80%"><caption align=bottom></caption><tr><td valign="middle" bgcolor="#FBFDE0"><pre><code>

    RadioButton status;
    int eccSector, page;

    USlider *xList, *yList, *dqList, *ndqList;
             xList = yList = dqList = ndqList = 0;

    FailListAccessHandle flAH:
    DutCursor dutcsr;
    UT_DUT dut;
    USlider failcount;
    int dutCount;

    flAH = <a href="../../../ATFSsys/html/en/mci_en_UTL_GetFailListAccessHandle.html">UTL_GetFailListAccessHandle</a>();

    <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessTestSelect.html">UTL_SetFailListAccessTestSelect</a>   (flAH, UT_FL_TESTSEL_NAME);
    <a href="../../../ATFSsys/html/en/mci_en_UTL_ClearFailListAccessTestName.html">UTL_ClearFailListAccessTestName</a>   (flAH);
    <a href="../../../ATFSsys/html/en/mci_en_UTL_AddFailListAccessTestName.html">UTL_AddFailListAccessTestName</a>     (flAH, testname);
    <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessDeviceChannel.html">UTL_SetFailListAccessDeviceChannel</a>(flAH, 1);
    <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessAllBit.html">UTL_SetFailListAccessAllBit</a>       (flAH, UT_ON);

    dutcsr = <a href="../../../ATFSsys/html/en/mci_en_UTL_GetDutCursor.html">UTL_GetDutCursor</a>(UT_DDUT);
    while ( (dut = <a href="../../../ATFSsys/html/en/mci_en_UTL_NextDut.html">UTL_NextDut</a>(dutcsr)) != UT_NOMORE ) {
        <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessDut.html">UTL_SetFailListAccessDut</a>  (flAH, dut);

        <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessXAddr.html">UTL_SetFailListAccessXAddr</a>(flAH, 0x0, PAGES_PER_BLOCK * BLOCK_COUNT - 1);
        <a href="../../../ATFSsys/html/en/mci_en_UTL_SetFailListAccessYAddr.html">UTL_SetFailListAccessYAddr</a>(flAH, 0,   COLUMNS_PER_PAGE - 1);

        failCount = <a href="../../../ATFSsys/html/en/mci_en_UTL_ReadFailListAddressCount.html">UTL_ReadFailListAddressCount</a>(flAH, &amp;status);
        printf(&quot;The number of failing addresses:%d\n&quot;, failCount);

        dutCount = <a href="../../../ATFSsys/html/en/mci_en_UTL_GetDutCount.html">UTL_GetDutCount</a>(UT_DDUT);

        xList    = (unsigned int *)malloc(failCount * sizeof(unsigned int));
        yList    = (unsigned int *)malloc(failCount * sizeof(unsigned int));
        dqList   = (unsigned int *)malloc(failCount * sizeof(unsigned int));
        ndqList  = (unsigned int *)malloc(failCount * sizeof(unsigned int));

        <a href="../../../ATFSsys/html/en/mci_en_UTL_ReadFailList.html">UTL_ReadFailList</a>(flAH, xList, yList, dqList, ndqList, failCount);

        for (i = 0; i &lt; failCount; i++) { /* Loop through all failures */

            /* Determine which ECC sector that this failure belongs to */
            for (j = 0; j &lt; ECC_SECTORS_PER_PAGE; j++) {

                if (yList[i] &lt; ((j+1) * (COLUMN_COUNT / ECC_SECTORS_PER_PAGE))) {
                    eccSector = j;
                    printf (&quot;ECC Sector:%d, page:0x%04x, col:0x%04x\n&quot;,
                             eccSector,     xList[i],    yList[i]);
                    break; /* The ECC Sector has been determined */
                }
            }

            page = xList[i]; /* Identify the current page */

            printf(&quot;DUT[%2d] Page:%d, EccSec:%02d, X:%08x, Y:%08x, DQ:%04x, nDQ:%04x\n&quot;,
                    dut,     page,    eccSector,   xList[i],yList[i],dqList[i],ndqList[i]);

        } /* failCount */

        if (xList)   { free(xList;    xList=0;   }
        if (yList)   { free(yList);   yList=0;   }
        if (dqList)  { free(dqList);  dqList=0;  }
        if (ndqList) { free(ndqList); ndqList=0; }

    } /* dutcsr */

    <a href="../../../ATFSsys/html/en/mci_en_UTL_DeleteCursor.html">UTL_DeleteCursor</a>(dutcsr);
    <a href="../../../ATFSsys/html/en/mci_en_UTL_DeleteHandle.html">UTL_DeleteHandle</a>(flAH);
</code></pre></td></tr></table></a></p>
<HR>
<A HREF="mci_en_fla.examples.html">[Up]</A>
<A HREF="mci_en_fla.examples.UTL_WriteFailListBadBlock.html">[Prev]</A>
<A HREF="mci_en_fla.examples.UTL_WriteFailList.html">[Next]</A>
<HR>
<A HREF="mci_en_TOC.html">Table of Contents</A>
<DIV ALIGN=RIGHT>FutureSuite MCI Reference Manual</DIV>
</BODY>
</HTML>
